# Example Astropix3 config
#
# The following yaml should comply to the structure below.
# It is important, that the order of configbits under the config section, corresponds to the actual order in the chip --> Genau das hat Nicolas mir auch gesagt
#
# astropix<version>:
#   geometry:
#       cols: <number of cols>
#       rows: <number of rows>
#   config:
#       <group-name>:
#           <configbit-name>: [<number of bits>, <value>]
#   ...
#
---
astropix4:
    general:
        sampleclockperiod_ns: 10
    geometry:
        cols: 3
        rows: 1
    configcards:
        voltagecard:
            pos: 4
            dacs: [0, 0, 1.1, 1, 0, 0, 0.8, 1.2]
        injectioncard:
            pos: 3
    config:
        digitalconfig:
            interrupt_pushpull: [1, 0b0]
            clkmux:             [1, 0b0]
            timerend:           [4, 0b0]
            slowdownldpix:      [4, 0]
            slowdownldcol:      [5, 0]
            maxcyc:             [6, 63]
            resetckdiv:         [4, 0b1111]
            nu1:                [32, 0b0]
            tdacmux:            [1, 0b0]
            Reset:              [1, 0b0]
            PCH:                [1, 0b0]
            enRamPCH:           [1, 0b1]
            nu2:                [5, 0b0]
            enLVDSterm:         [1, 0b1]
            enPLL:              [1, 0b1]
            enLVDS:             [1, 0b0]
            nu3:                [5, 0b0]

        biasconfig:
            DisHiDR:            [1, 0b1]
            q01:                [1, 0b0]
            qon0:               [1, 0b0]
            qon1:               [1, 0b1]
            qon2:               [1, 0b0]
            qon3:               [1, 0b1]

        idacs:
            blres:              [6, 0]
            vpdac:              [6, 0]
            vn1:                [6, 20]
            vnfb:               [6, 1]
            vnfoll:             [6, 2]
            nu5:                [6, 0]
            vndel:              [6, 30]
            incp:               [6, 10]
            ipvco:              [6, 0]
            vn2:                [6, 0]
            vnfoll2:            [6, 1]
            vnbias:             [6, 10]
            vpload:             [6, 1]
            nu13:               [6, 0]
            vncomp:             [6, 2]
            vpfoll:             [6, 10]
            nu16:               [6, 0]
            vprec:              [6, 10]
            vnrec:              [6, 10]

        vdacs:
            blpix:              [10, 568]
            thpix:              [10, 610]
            vcasc2:             [10, 625]
            vtest:              [10, 682]
            vinj:               [10, 171]

        recconfig:
            col0:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col1:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col2:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col3:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col4:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col5:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col6:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col7:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col8:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col9:               [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col10:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col11:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col12:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col13:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col14:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]
            col15:              [38, 0b001_11111_11111_11111_11111_11111_11111_11110]

    tdac_config:
        row0:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row1:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row2:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row3:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row4:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row5:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row6:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row7:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row8:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row9:               [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row10:              [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row11:              [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]
        row12:              [80, 0b00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001_00001]

    column_control:             # Test Chip with only 3 Pixels!
        EnInj0:         [1, 0]
        RamWr0:         [5, 0]
        Amp0:           [1, 0]
        Inj0:           [1, 0]
        RamIn0:         [1,0]
        EnB_HBRec0:     [1,0]
        EnInj1:         [1, 0]
        RamWr1:         [5, 0]
        Amp1:           [1, 0]
        Inj1:           [1, 0]
        RamIn1:         [1,0]
        EnB_HBRec1:     [1,0]
        EnInj2:         [1, 0]
        RamWr2:         [5, 0]
        Amp2:           [1, 0]
        Inj2:           [1, 0]
        RamIn2:         [1,0]
        EnB_HBRec2:     [1,0]

    bias_block:
        idac15:         [6,0]
        idac14:         [6,0]
        idac13:         [6,0]
        idac12:         [6,0]
        idac8:          [6,0]
        idac11:         [6,0]
        idac10:         [6,0]
        VNBiasComp:     [6,0]
        VN:             [6,0]
        idac6:          [6,0]
        idac5:          [6,0]
        VNSF:           [6,0]
        idac3:          [6,0]
        idac2:          [6,0]
        VNBiasRec2:     [6,0]
        VNBiasRec:      [6,0]
    
    vdac_block:
        BL:             [8,0]    # VDAC has sign bit with bit 0! -127 to +127 range
        Vth:            [8,0]
        Vcasc:          [8,0]

